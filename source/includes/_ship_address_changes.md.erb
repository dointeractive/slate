# Адрес доставки

## Получение списка возможных изменений в заказе

```shell
curl "<%= config[:host] %>/orders/R2104267/ship_address_change?ship_address[address_id]=1" 
```

> Команда выше возвращает JSON:

```json
{
  "ship_address_change": {
    "losses": [{
      "retailer": {
        "id": 4713,
        "name": "Metro0",
        "color": "#003d7a",
        "logo": "https://www.metrogroup.de/~/assets/mag/images/teasers/metro-logo.png",
        "available": true,
        "environment": "production"
      },
      "offers": [{
        "id": 5725,
        "sku": "T10001",
        "name": "Product #0",
        "price": "1236.7",
        "original_price": "1236.7",
        "discount": "0.0",
        "human_volume": "100 \u0433.",
        "items_per_pack": 1,
        "images": []
      }]
    }]
  }
}

```

В результате изменения адреса доставки может измениться список доступных магазинов, некоторые товары из корзины станут при этом недоступны. Чтобы получить список возможных изменений необходимо выполнить запрос:

### HTTP запрос

`GET <%= config[:host] %>/orders/#{NUMBER}/ship_address_change`


## Изменения адреса доставки

```shell
curl "<%= config[:host] %>/orders/R2104267/ship_address_change" \
  -X PUT
  -d ship_address[address_id]=1
```

> Команда выше возвращает JSON:

```json
{
  "ship_address_change": {
    "order": {
      "number": "R704735386",
      "total": "1236.7",
      "item_count": 0,
      "item_total": "1236.7",
      "ship_total": 0,
      "adjustment_total": "0.0",
      "promo_total": 0,
      "shipment_state": null,
      "payment_state": null,
      "special_instructions": null,
      "created_at": "2017-07-26T02:59:28.000+03:00",
      "updated_at": "2017-07-26T02:59:29.858+03:00",
      "completed_at": null,
      "address": {
        "id": 1736,
        "first_name": "Ivan",
        "last_name": "Fedorov",
        "full_address": "Full address",
        "city": "Москва",
        "street": "Фридриха Энгельса",
        "building": "56 c.3",
        "block": null,
        "apartment": null,
        "comments": null,
        "lat": null,
        "lon": null
      },
      "payment": null,
      "shipments": []
    },
    "losses": [{
      "retailer": {
        "id": 4714,
        "name": "Metro3",
        "color": "#003d7a",
        "logo": "https://www.metrogroup.de/~/assets/mag/images/teasers/metro-logo.png",
        "available": true,
        "environment": "production"
      },
      "offers": [{
        "id": 5726,
        "sku": "T10002",
        "name": "Product #1",
        "price": "1236.7",
        "original_price": "1236.7",
        "discount": "0.0",
        "human_volume": "100 \u0433.",
        "items_per_pack": 1,
        "images": []
      }]
    }]
  }
}

```

Изменить адрес доставки можно выполнив запрос

### HTTP запрос

`PUT <%= config[:host] %>/orders/#{NUMBER}/ship_address_change`
