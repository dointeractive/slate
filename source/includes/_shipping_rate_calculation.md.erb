# Детализация стоимости доставки

## Запрос на получение детализации стоимости для доставки


```shell
curl "<%= config[:host] %>/shipments/#{NUMBER}/shipping_rate_calculation?delivery_window_id=#{delivery_window_id}" \
  -H "Authorization: Token token=#{TOKEN}"
```

```ruby
   #сложный калькулятор
   total_cost = surge_amount + preferences.base_price + price_adjustments.values.sum
```

```ruby
   #простой калькулятор
   total_cost = surge_amount + preferences.price
```

> Ответ будет содержать следующие данные:
> Для сложного калькулятора

```json
{
  "shipping_rate_calculation": {
    "total_cost": 590.0,
    "surge_amount": 100.0,
    "preferences": {
      "base_price": 490.0,
      "base_weight": 80.0,
      "base_items_count": 30,
      "extra_weight_batch": 40.0,
      "fee_per_extra_weight_batch": 49.0,
      "extra_items_count_batch": 5,
      "fee_per_extra_items_count_batch": 29.0
    },
    "price_adjustments": {
      "fee_per_extra_weight": 0,
      "fee_per_extra_items_count": 0
    }
  }
}
```

> Для простого калькулятора

```json
{
  "shipping_rate_calculation": {
    "total_cost": 590.0,
    "surge_amount": 100.0,
    "preferences": {
      "price": 490.0
    },
    "price_adjustments": {}
  }
}
```


Получить детализацию стоимости для доставки, выполнив запрос:

`GET <%= config[:host] %>/shipments/#{NUMBER}/shipping_rate_calculation`

### Параметры запроса

Параметр | Обязательный | Описание
--------- | ------- | -----------
NUMBER | Да | Номер доставки
delivery_window_id | Да | Id слота доставки

### Структура объекта shipping_rate_calculation

Атрибут | Описание
--------- | -----------
total_cost | Полная стоимость доставки
surge_amount | Наценка интервала доставки
preferences | Список настроек калькулятора использовавшегося для расчета
price_adjustments | Расчитанные надбавки для стоимости доставки

### Структура объекта preferences для сложного калькулятора

Атрибут | Описание
--------- | -----------
base_price | Базовая стоимость доставки
base_weight | Базовый вес доставки
base_items_count | Базовае количество товаров
extra_weight_batch | Дополнительный вес
extra_items_count_batch | Дополнительное количество товаров
fee_per_extra_weight_batch | Надбавка за вес превышающий базовый
fee_per_extra_items_count_batch | Надбавка дополнительные товары свех базоваго количества

### Структура объекта preferences для простого калькулятора

Атрибут | Описание
--------- | -----------
price | Базовая стоимость доставки

### Структура объекта price_adjustments для сложного калькулятора (для простого пустой объект)

Атрибут | Описание
--------- | -----------
fee_per_extra_weight | Рассчитанная надбавка за вес превышающий базовый
fee_per_extra_items_count | Рассчитанная надбавка количество товаров превышаюее базовое
