# Сборка подзаказа

## Получение детализации по сборке подзаказа

> Пример кода для получения детализации по сборке подзаказа

```shell
curl "<%= config[:host] %>/shipments/H0123412/assembly_items" \
   -H "Authorization: Token token=#{TOKEN}" \
```

> Ответ будет содержать следующие данные:

```json
{
    "assembly_items": [
        {
            "sku": "10004",
            "name": "Product #4",
            "pcs": 1,
            "found_pcs": 1,
            "quantity": 0.5,
            "found_quantity": 0.5,
            "price": 1236.7,
            "new_price": 1236.7,
            "price_type": "per_kilo",
            "state": "pending",
            "human_volume": "200 г",
            "items_per_pack": 1,
            "image": "/spree/products/12/small/4.jpg?1549977679",
            "replacement": null
        },
        {
            "sku": "10012",
            "name": "Product #12",
            "pcs": 6,
            "found_pcs": 6,
            "quantity": 3,
            "found_quantity": 3,
            "price": 1136.7,
            "new_price": 1136.7,
            "price_type": "per_kilo",
            "state": "replaced",
            "human_volume": "200 г x 6",
            "items_per_pack": 6,
            "image": null,
            "replacement": {
                "sku": "10001",
                "name": "Product #1",
                "pcs": 6,
                "found_pcs": 6,
                "quantity": 3,
                "found_quantity": 3,
                "price": 1236.7,
                "new_price": 1236.7,
                "price_type": "per_kilo",
                "state": "pending",
                "human_volume": "200 г x 6",
                "items_per_pack": 6,
                "image": "/spree/products/9/small/1.jpg?1549977678",
                "replacement": null
            }
        }
    ],
    "meta": {
        "current_page": 1,
        "next_page": null,
        "total_pages": 1,
        "per_page": 30,
        "total_count": 2
    }
}
```

Детализацию по сборке подзаказа можно получить, выполнив запрос:

`GET <%= config[:host] %>/shipments/{{number}}/assembly_items`

Если позиция подзаказа заменена (`state == "replaced"`), то поле `replacement` содержит позицию на которую была произведена замена.

Поле `state` может принимать следующие значения:
- `assembled` - позиция собрана,
- `canceled` - позиция отменена,
- `replaced` - позиция заменена,
- `pending` - к сборке позиции не приступали

### Параметры запроса

Параметр   | Обязательный | Описание
-----------| ------------ | --------
`number`   | Да           | Номер подзаказа
`state`    | Нет          | Фильтр на статус возвращаемых позиций заказа. Доступные значения:`assembled`, `canceled`, `replaced`
`page`     | Нет          | Номер страницы (по умолчанию 1)
`per_page` | Нет          | Количество позиций заказа на странице (по умолчанию 30)

