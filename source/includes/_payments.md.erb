# Оформление платежа

При оформлении заказа пользователь выбирает один из способов оплаты, которым он будет оплачивать заказ.

Для совершения платежа некоторые способы оплаты требуют дополнительных действий со стороны пользователя на стороннем сайте. API возвращает необходимую для этого информацию вместе с заказом, в объекте Payment.

### Структура объекта Payment

Атрибут | Описание
--------- | -----------
number | номер платежа
state | состояние платежа
is_finalization_needed | требуется ли оформление платежа
finalization_url | url перехода для оформления платежа

Если выбранный пользователем способ оплаты предполагает оформление платежа на стороннем сайте, то поле `is_finalization_needed` будет содержать значение `true`. В этом случае клиент API должен отобразить пользователю сайт внутри web-view компонента по ссылке из поля `finalization_url`.

Пользователь осуществляет оплату (включая 3d-secure авторизацию) внутри этого компонента.
После завершения оплаты пользователь будет переадресован на сайт instamart.ru, на адрес `/api/v2/credit_card_authorization?payment_number=#{number}`

В зависимости от успешности завершения оплаты произойдет переадресация на один из следующих адресов:

Сигналом успешного завершения оплаты будет переадресация на адрес хост `/api/v2/credit_card_authorization/success`
Сигналом неуспешного завершения оплаты будет переадресация на адрес хост `/api/v2/credit_card_authorization/fail`
