<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Документация Instamart API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'></a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="vviedieniie">Введение</h1>

<p>Спецификация API Instamart</p>

<blockquote>
  <p>API endpoint</p>
</blockquote>

<pre class="highlight shell"><code>http://api.instamart.ru
</code></pre>

<p>Instamart API построено в соответствии с архитектурой REST. Все URL в API имеют единую структуру и соответствуют отдельным ресурсам. Ответы API используют HTTP коды состояния для обозначения результата выполнения запроса. Мы используем встроенные механизмы HTTP, такие как HTTP методы, HTTP аутентификация и заголовки, которые поддерживаются всеми HTTP клиентами. Все запросы к API возвращают ответ в формате JSON, со всеми данными, включая ошибки.</p>

<p>Чтобы облегчить изучение API пользователю предоставляется тестовый API ключ.</p>


          <h1 id="polzovatieli">Пользователи</h1>

<h2 id="rieghistratsiia-novogho-polzovatielia">Регистрация нового пользователя</h2>

<blockquote>
  <p>Пример кода для регистрации нового пользователя:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/users'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d user[email]<span class="o">=</span><span class="c">#{EMAIL} \</span>
  -d user[first_name]<span class="o">=</span><span class="c">#{FIRSTNAME} \</span>
  -d user[last_name]<span class="o">=</span><span class="c">#{LASTNAME} \</span>
  -d user[password]<span class="o">=</span><span class="c">#{PASSWORD}</span>
</code></pre>

<p>Зарегистрировать нового пользователя можно, выполнив запрос:</p>

<p><code>POST https://api.instamart.ru/v2/users</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>user[email]</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
    <tr>
      <td>user[password]</td>
      <td>Да</td>
      <td>Пароль</td>
    </tr>
    <tr>
      <td>user[first_name]</td>
      <td>Да</td>
      <td>Имя пользователя</td>
    </tr>
    <tr>
      <td>user[last_name]</td>
      <td>Да</td>
      <td>Фамилия пользователя</td>
    </tr>
    <tr>
      <td>user[location]</td>
      <td>Нет</td>
      <td>Местоположение пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="izmienieniie-dannykh-polzovatielia">Изменение данных пользователя</h2>

<blockquote>
  <p>Пример кода для изменения, местоположения пользователя:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/users/test@test.com'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Token token=#{TOKEN}'</span> <span class="se">\</span>
  -X PUT <span class="se">\</span>
  -d user[location]<span class="o">=</span>Perm
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ivan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Petrov"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Perm"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Изменить данные пользоватeля можно, выполнив следующий запрос:</p>

<p><code>PUT https://api.instamart.ru/v2/users/#{EMAIL}</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
    <tr>
      <td>user[first_name]</td>
      <td>-</td>
      <td>Имя пользователя</td>
    </tr>
    <tr>
      <td>user[last_name]</td>
      <td>-</td>
      <td>Фамилия пользователя</td>
    </tr>
    <tr>
      <td>user[location]</td>
      <td>-</td>
      <td>Местоположение пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="poluchieniie-dannykh-polzovatielia">Получение данных пользователя</h2>

<blockquote>
  <p>Пример кода, чтобы определить зарегистрирован пользователь или нет:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/users/test@test.com'</span>
</code></pre>
<blockquote>
  <p>Если пользователь существует, ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Если пользователя не существует, сервер вернет ответ с кодом 404.<br />Если в запросе указать заголовок Authorization, то ответ будет содержать дополнительные данные:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/users/test@test.com'</span>
  -H <span class="s1">'Authorization: Token token=#{TOKEN}'</span>
</code></pre>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ivan"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Petrov"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Moscow"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить данные пользователя можно, выполнив запрос:<br />
<code>GET https://api.instamart.ru/v2/users/#{EMAIL}</code></p>

<p>Запрос к этому ресурсу можно выполнять как с указанием токена аутентификации так и без. Без указания токена сервер вернет ограниченное количество информации.</p>

<h3 id="paramietry-zaprosa-2">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

          <h1 id="autientifikatsiia">Аутентификация</h1>

<p>Для доступа к API Instamart пользователь должен пройти процедуру аутентификации и получить токен доступа.</p>

<h2 id="autientifikatsiia-chieriez-iemieil-i-parol">Аутентификация через емейл и пароль</h2>

<blockquote>
  <p>Пример кода для аутентификации пользователя с учетными данными “test@test.ru”, “qwer”:</p>
</blockquote>

<pre class="highlight shell"><code><span class="nv">email</span><span class="o">=</span><span class="nb">test</span>@test.ru
<span class="nv">pass</span><span class="o">=</span>qwer
<span class="nv">credentials</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$email</span>:<span class="nv">$pass</span> | base64<span class="k">)</span>
curl <span class="s2">"http://api.instamart.ru/v2/sessions"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s2">"Authorization: Basic </span><span class="nv">$credentials</span><span class="s2">"</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"session"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FWtn0HAjBD6rNxWwEV0Cj7JXSEPGJQ"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Аутентификация осуществляется методом <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basic Auth</a>.</p>

<p>Получить токен можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v2/sessions</code></p>

<p>Учетные данные пользователя (емейл и пароль) передаются в заголовке запроса вида:<br />
<code>Authorization: Basic #{DIGEST}</code><br />
где <code>#{DIGEST}</code> формируется следующим способом: <code>base64(email + ':' + password)</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
    <tr>
      <td>password</td>
      <td>Да</td>
      <td>Пароль пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="autientifikatsiia-chieriez-sotsialnyie-sieti">Аутентификация через социальные сети</h2>

<blockquote>
  <p>Пример кода для аутентификации пользователя через vkontakte</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/auth_providers/vkontakte/sessions"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d session[uid]<span class="o">=</span>0 <span class="se">\</span>
  -d session[first_name]<span class="o">=</span>fname <span class="se">\</span>
  -d session[last_name]<span class="o">=</span>lname <span class="se">\</span>
  -d session[email]<span class="o">=</span>mail@example.com
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"session"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FWtn0HAjBD6rNxWwEV0Cj7JXSEPGJQ"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить токен можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v2/auth_providers/#{PROVIDER_ID}/sessions</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>provider_id</td>
      <td>Да</td>
      <td>Название социальной сети (vkontakte / facebook)</td>
    </tr>
    <tr>
      <td>session[uid]</td>
      <td>Да</td>
      <td>Идентификатор пользователя в социальной сети</td>
    </tr>
    <tr>
      <td>session[first_name]</td>
      <td>Да (в первый раз)</td>
      <td>Имя пользователя</td>
    </tr>
    <tr>
      <td>session[last_name]</td>
      <td>Да (в первый раз)</td>
      <td>Фамилия пользователя</td>
    </tr>
    <tr>
      <td>session[email]</td>
      <td>Да (в первый раз)</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="provierka-tokiena">Проверка токена</h2>

<p>Проверить токен можно, выполнив запрос:<br />
<code>GET http://api.instamart.ru/v2/sessions/#{ACCESS_TOKEN}</code></p>

          <h1 id="vosstanovlieniie-parolia">Восстановление пароля</h1>

<h2 id="zapros-na-vosstanovlieniie-parolia">Запрос на восстановление пароля</h2>

<blockquote>
  <p>Пример кода c запросом на “восстановление пароля”</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/passwords/reset'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d password_reset[email]<span class="o">=</span><span class="c">#{EMAIL}</span>
</code></pre>

<blockquote>
  <p>Если пользователя не существует, то сервер вернет ответ с кодом 404</p>
</blockquote>

<aside class="warning">
  not implemented
</aside>

<p>Отправить пользователю письмо с инструкцией “восстановления пароля” можно, выполнив запрос:<br />
<code>POST https://api.instamart.ru/v2/passwords/reset</code></p>

<p>Письмо будет содержать ссылку на приложение с параметром <code>reset_password_token</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>password_reset[email]</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="sbros-parolia">Сброс пароля</h2>

<blockquote>
  <p>Пример кода c запросом сброса пароля</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/passwords'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d password_reset[reset_password_token]<span class="o">=</span><span class="c">#{TOKEN}</span>
  -d password_reset[password]<span class="o">=</span><span class="c">#{PASSWORD}</span>
  -d password_reset[password_confirmation]<span class="o">=</span><span class="c">#{PASSWORD_CONFIRMATION}</span>
</code></pre>

<aside class="warning">
  not implemented
</aside>

<p>Сбросить пароль пользователя можно, выполнив запрос:<br />
<code>POST https://api.instamart.ru/v2/passwords</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>password_reset[reset_password_token]</td>
      <td>Да</td>
      <td>Токен для сброса пароля</td>
    </tr>
    <tr>
      <td>password_reset[password]</td>
      <td>Да</td>
      <td>Пароль</td>
    </tr>
    <tr>
      <td>password_reset[password_confirmation]</td>
      <td>Да</td>
      <td>Подтверждение пароля</td>
    </tr>
  </tbody>
</table>

          <h1 id="riefieralnaia-proghramma">Реферальная программа</h1>

<blockquote>
  <p>Пример получения реферальной программы пользователя:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v2/promotions/referral'</span>
  -H <span class="s1">'Authorization: Token token=#{TOKEN}'</span>
</code></pre>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"referral_promotion"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Пригласи друга"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Отправь друзьям ссылку и получи 400р."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"usage_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"usage_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
    </span><span class="nt">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABC67CD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"link"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/R/ABCD67CD"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Реферальную программу пользователя можно получить, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/promotions/referral</code></p>


          <h1 id="goroda-obsluzhivaniia">Города обслуживания</h1>

<blockquote>
  <p>Пример проверки доступности Instamart в Москве:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/operational_zones?location=Москва"</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"zones"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Проверить доступен Instamart в указанном городе или нет можно, выполнив следующий запрос:</p>

<h3 id="http-zapros">HTTP запрос</h3>

<p><code>GET http://api.instamart.ru/v2/operational_zones</code></p>

<p>В случае если Instamart не осуществляет доставку в указанный населенный пункт API вернет ошибку <code>404</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>location</td>
      <td>Да</td>
      <td>Город, поселок, населенный пункт пользователя</td>
    </tr>
  </tbody>
</table>

          <h1 id="adriesa-polzovatieliei">Адреса пользователей</h1>

<h2 id="poluchieniie-spiska-adriesov">Получение списка адресов</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/addresses"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> 
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w"> 
  </span><span class="nt">"addresses"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Иван"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Петров"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"full_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса 56"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"building"</span><span class="p">:</span><span class="w"> </span><span class="s2">"56"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"block"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"apartment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lat"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nt">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить список всех адресов можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/addresses</code></p>

<h2 id="sozdaniie-novogho-adriesa">Создание нового адреса</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/addresses"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s2">"address[full_address]=Фридриха Энгельса 56"</span> <span class="se">\</span>
  -d <span class="s2">"address[street]=Фридриха Энгельса"</span> <span class="se">\</span>
  -d <span class="s2">"address[building]=56"</span> 
</code></pre>

<blockquote>
  <p>В случае если данные были указаны верно, сервер вернет ответ:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Иван"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Петров"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"full_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса 56"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"building"</span><span class="p">:</span><span class="w"> </span><span class="s2">"56"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"block"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"apartment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lat"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Добавить новый адрес пользователя можно, выполнив запрос:</p>

<p><code>POST http://api.instamart.ru/v2/addresses</code></p>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>address[first_name]</td>
      <td>-</td>
      <td>Имя пользователя/контактого лица</td>
    </tr>
    <tr>
      <td>address[last_name]</td>
      <td>-</td>
      <td>Фамилия пользоватя/контактного лица</td>
    </tr>
    <tr>
      <td>address[full_address]</td>
      <td>Да (временно)</td>
      <td>Полный адрес (в ближайшие дни уберем это поле)</td>
    </tr>
    <tr>
      <td>address[city]</td>
      <td>Да</td>
      <td>Город</td>
    </tr>
    <tr>
      <td>address[street]</td>
      <td>Да</td>
      <td>Улица</td>
    </tr>
    <tr>
      <td>address[building]</td>
      <td>Да</td>
      <td>Номер дома</td>
    </tr>
    <tr>
      <td>address[block]</td>
      <td>-</td>
      <td>Строение</td>
    </tr>
    <tr>
      <td>address[apartment]</td>
      <td>-</td>
      <td>Номер квартиры</td>
    </tr>
    <tr>
      <td>address[comments]</td>
      <td>-</td>
      <td>Комментарий к адресу</td>
    </tr>
    <tr>
      <td>address[lon]</td>
      <td>-</td>
      <td>Долгота</td>
    </tr>
    <tr>
      <td>address[lat]</td>
      <td>-</td>
      <td>Широта</td>
    </tr>
  </tbody>
</table>

<h2 id="riedaktirovaniie-adriesa">Редактирование адреса</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/addresses/2"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X PUT <span class="se">\</span>
  -d <span class="s2">"address[building]=53"</span>
</code></pre>

<blockquote>
  <p>В случае если данные были указаны верно, сервер вернет ответ:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Иван"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Петров"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"full_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса 56"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"street"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Фридриха Энгельса"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"building"</span><span class="p">:</span><span class="w"> </span><span class="s2">"53"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"block"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"apartment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"comments"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lat"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"lon"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Изменить адрес можно, выполнив запрос:</p>

<p><code>PUT http://api.instamart.ru/v2/addresses/#{ID}</code></p>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>address[first_name]</td>
      <td>-</td>
      <td>Имя пользователя/контактого лица</td>
    </tr>
    <tr>
      <td>address[last_name]</td>
      <td>-</td>
      <td>Фамилия пользоватя/контактного лица</td>
    </tr>
    <tr>
      <td>address[full_address]</td>
      <td>-</td>
      <td>Полный адрес (в ближайшие дни уберем это поле)</td>
    </tr>
    <tr>
      <td>address[city]</td>
      <td>-</td>
      <td>Город</td>
    </tr>
    <tr>
      <td>address[street]</td>
      <td>-</td>
      <td>Улица</td>
    </tr>
    <tr>
      <td>address[building]</td>
      <td>-</td>
      <td>Номер дома</td>
    </tr>
    <tr>
      <td>address[block]</td>
      <td>-</td>
      <td>Строение</td>
    </tr>
    <tr>
      <td>address[apartment]</td>
      <td>-</td>
      <td>Номер квартиры</td>
    </tr>
    <tr>
      <td>address[comments]</td>
      <td>-</td>
      <td>Комментарий к адресу</td>
    </tr>
    <tr>
      <td>address[lon]</td>
      <td>-</td>
      <td>Долгота</td>
    </tr>
    <tr>
      <td>address[lat]</td>
      <td>-</td>
      <td>Широта</td>
    </tr>
  </tbody>
</table>

<h2 id="udalieniie-adriesa">Удаление адреса</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/addresses/2"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
  <p>В случае успешного удаления сервер вернет пустой ответ с кодом 200</p>
</blockquote>

<p>Удалить адрес можно, выполнив запрос:</p>

<p><code>DELETE http://api.instamart.ru/v2/addresses/#{ID}</code></p>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ID</td>
      <td>Да</td>
      <td>id адреса</td>
    </tr>
  </tbody>
</table>

          <h1 id="ritieiliery">Ритейлеры</h1>

<h2 id="poluchieniie-spiska-ritieilierov">Получение списка ритейлеров</h2>

<pre class="highlight shell"><code>curl <span class="s2">"https://api.instamart.ru/v2/retailers"</span> <span class="se">\</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"retailers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Metro"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#003d7a"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"logo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.metrogroup.de/~/assets/mag/images/teasers/metro-logo.png"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"available"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"environment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить список ритейлеров подключенных к Instamart можно выполнив запрос</p>

<h3 id="http-zapros">HTTP запрос</h3>

<p><code>GET https://api.instamart.ru/v2/retailers</code></p>

          <h1 id="katieghorii">Категории</h1>

<blockquote>
  <p>Пример кода для получения списка всех категорий</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/categories?rid=1"</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"categories"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">466</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"department"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай и кофе"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"children"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">187</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"taxon"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/taxons/187/mini/%D1%87%D0%B0%D0%B8%CC%86-01.png?1453649106"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"normal_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/taxons/187/normal/%D1%87%D0%B0%D0%B8%CC%86-01.png?1453649106"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}],</span><span class="w">

  </span><span class="nt">"promoted_categoris"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>API возвращает полную иерархию всех категорий. Ответ содержит два объекта верхего уровня: <code>categories</code> и <code>promoted_categories</code>.<br />
<code>categories</code> – это список всех категорий сайта. <code>promoted_categories</code> – список маркетинговых категорий “скидки”, “новогоднее предложение” и пр.<br />
Все объекты категорий имеют следующую структуру:</p>

<h3 id="struktura-obiekta-category">Структура объекта Category</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>id категории</td>
    </tr>
    <tr>
      <td>type</td>
      <td>Тип категории: <strong>department</strong> или <strong>taxon</strong></td>
    </tr>
    <tr>
      <td>name</td>
      <td>Название категори</td>
    </tr>
    <tr>
      <td>children</td>
      <td>Список дочерних категорий</td>
    </tr>
  </tbody>
</table>

<p>От значения поля <code>type</code> зависит способ отображения содержимого категории.<br />
Если <code>type</code> содержит значение “department” – для отоброжения содержимого категории нужно использовать API <code>/v2/departments</code>. Если <code>type</code> содержит “taxon” – нужно использовать API <code>/v2/products</code></p>

<p>Получить список всех категорий можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/categories</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список категорий.</td>
    </tr>
  </tbody>
</table>

          <h1 id="katalogh">Каталог</h1>

<blockquote>
  <p>Отдел с дочерними отделами</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай и кофе"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">668</span><span class="p">,</span><span class="w">
  </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Отдел без дочерних отделов</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"taxon_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">232</span><span class="p">,</span><span class="w">
  </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>API каталога возвращает особое представление структуры категорий – “отделы”. Отделы можно использовать для отображения главного экрана и экранов категорий.<br />
API каталога предоставляет отделы в виде двухуровнего дерева. Запрос списка отделов всегда возвращает отделы “верхнего уровня”. Отдел “верхнего уровня” может иметь дочерние отделы и в этом случае он может быть отображен на экране категорий, для этого в документ включено поле <code>id</code>. Если отдел “верхнего уровня” не имеет дочерних отделов, его не нужно отображать на экране категорий, поэтому в документе у него отсутствует поле <code>id</code>, вместо этого документ содержит поле <code>taxon_id</code>, которое можно использовать для вывода экрана с продуктами из этого отдела.<br />
Запрос отдела для экрана категории возвращает сам отдел, а также его дочерние отделы (“нижнего уровня”). Отделы “нижнего уровня” всегда имеют только поле <code>taxon_id</code>, и не имеют поля <code>id</code>.</p>

<h2 id="vydacha-dlia-ghlavnogho-ekrana">Выдача для главного экрана</h2>

<blockquote>
  <p>Пример команды</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/departments?rid=1'</span> <span class="se">\</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"departments"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">173</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бакалея"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1979</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1037</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11040"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Хлопья Nordic овсяные"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"125.35"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"125.35"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500 г."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5541/mini/11040.jpg?1473242574"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5541/small/11040.jpg?1473242574"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5541/product/11040.jpg?1473242574"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"original_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5541/original/11040.jpg?1473242574"</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nt">"deals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">428</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Скидки"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">910</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aisles"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"taxon_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">487</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бакалея"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">129</span><span class="p">,</span><span class="w">
        </span><span class="nt">"icon"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/taxons/487/mini/Бакалея.png?1453225221"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"normal_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/taxons/487/normal/Бакалея.png?1453225221"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>

<p>Получить выдачу для главной страницы можно, выполнив следующий запрос:</p>

<p><code>GET https://api.instamart.ru/v2/departments</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список товаров.</td>
    </tr>
  </tbody>
</table>

<p>Ответ содержит список документов <code>departments</code> и может содержать документ <code>deals</code>.<br />
Каждый элемент из списка <code>departments</code> должен обязательно включать одно из двух полей: <code>id</code> или <code>taxon_id</code>.<br />
Если документ содержит поле <code>id</code>, то его можно использовать для получения экрана категории.<br />
Если документ содержит поле <code>taxon_id</code>, то его можно использовать для получения списка продуктов.</p>

<p>Документ <code>deals</code> содержит данные для отображения продуктов из категории “скидки”.</p>

<h2 id="vydacha-ekrana-katieghorii">Выдача экрана категории</h2>

<blockquote>
  <p>Пример команды</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'https://api.instamart.ru/v2/departments/174?rid=1'</span> <span class="se">\</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай и кофе"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">668</span><span class="p">,</span><span class="w">
    </span><span class="nt">"aisles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_counts"</span><span class="p">:</span><span class="w"> </span><span class="mi">327</span><span class="p">,</span><span class="w">
        </span><span class="nt">"taxon_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">267</span><span class="p">,</span><span class="w">
        </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
            </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
            </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
            </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">150.0</span><span class="p">,</span><span class="w">
            </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 пак x 6"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
                </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="w">
              </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить выдачу страницы каталога можно, выполнив следующий запрос:</p>

<p><code>GET https://api.instamart.ru/v2/departments/#{DEPARTMENT_ID}</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список товаров.</td>
    </tr>
    <tr>
      <td>DEPARTMENT_ID</td>
      <td>Да</td>
      <td>id категории</td>
    </tr>
  </tbody>
</table>

<p>Ответ содержит расширенные данные для данной категории.<br />
Список подкатегорий лежит в поле <code>aisles</code> документа <code>department</code>.<br />
Каждый документ из списка <code>aisles</code> по структуре идентичен документу <code>department</code>, но может иметь только поле <code>taxon_id</code>.</p>

          <h1 id="produkty">Продукты</h1>

<h2 id="spisok-produktov">Список продуктов</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/products?rid=1"</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="mi">100000</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">54.79</span><span class="p">,</span><span class="w">
      </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">55.79</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">500.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500 г."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы желтые из Эквадора"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/1/mini/file.png"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/1/small/file.png"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/1/product/file.png"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="nt">"facets"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"brand"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бренд"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"select"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ahmad Tea"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"property"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Вид чая"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"multi_select"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Белый чай"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Зеленый чай"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}],</span><span class="w">

  </span><span class="nt">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Пример запроса с фильтрацией выборки продуктов:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/products?rid=1"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -d filter[brand][]<span class="o">=</span>1 <span class="se">\</span>
  -d filter[property][]<span class="o">=</span>4 <span class="se">\</span>
  -d filter[property][]<span class="o">=</span>7
</code></pre>

<p>Получить список продуктов доступных в текущий момент в Instamart можно, выполнив запрос:</p>

<h3 id="http-zapros">HTTP запрос</h3>

<p><code>GET http://api.instamart.ru/v2/products</code></p>

<p>API ограничивает максимальное число возвращаемых продуктов 24 объектами. Для доступа к остальным продуктам реализован интерфейс пагинации.<br />
Каждый запрос к <code>/v2/products</code> помимо самих продуктов также возвращает объект <code>meta</code>, указывающий номер текущей страницы, номер следующей страницы и общее количество страниц. Получить конкретную страницу с данными можно, указав параметр <code>page</code>.</p>

<h3 id="struktura-otvieta">Структура ответа</h3>

<table>
  <thead>
    <tr>
      <th>Объект</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>products</td>
      <td>Список продуктов</td>
    </tr>
    <tr>
      <td>facets</td>
      <td>Список фасетов для фильтрации списка продуктов</td>
    </tr>
    <tr>
      <td>meta</td>
      <td>Атрибуты пагинации</td>
    </tr>
  </tbody>
</table>

<h3 id="struktura-obiekta-facet">Структура объекта Facet</h3>

<p>API продуктов поддерживает фасетную фильтрацию списка продуктов. То есть выборка продуктов может быть уменьшена путем применения одного или нескольких фасетных фильтров. Данные необходимые для корректного отображения фасета хранятся в объекте Facet.</p>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>key</td>
      <td>Имя параметра в запросе</td>
    </tr>
    <tr>
      <td>name</td>
      <td>Название фасета</td>
    </tr>
    <tr>
      <td>type</td>
      <td>Тип, определяющий вид контрола: селект, мультиселект, интервал и т.п.</td>
    </tr>
    <tr>
      <td>options</td>
      <td>Список значений фасета для фильтрации</td>
    </tr>
  </tbody>
</table>

<p>На данный момент доступны следующие типы фасетов:</p>

<table>
  <thead>
    <tr>
      <th>Тип</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>select</td>
      <td>Выбор одного значение из множества</td>
    </tr>
    <tr>
      <td>multi_select</td>
      <td>Выбор множества значений</td>
    </tr>
  </tbody>
</table>

<h3 id="filtratsiia-produktov">Фильтрация продуктов</h3>

<p>Фильтрация списка продуктов выполняется передачей значения фасета в параметрах запроса.</p>

<p>Название параметра запроса формируется по шаблону <code>filter[#{FACET_KEY}][]</code>, где <code>FACET_KEY</code> это значение поля <code>key</code> из объекта <code>Facet</code>. Например, если мы хотим получить выборку продуктов, состоящую только из “Зеленого чая”, в параметрах запроса надо передать следующее значение: <code>filter[property][]=3</code>.</p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rid</td>
      <td>Да</td>
      <td>ID ритейлера</td>
    </tr>
    <tr>
      <td>tid</td>
      <td>Да</td>
      <td>ID категории</td>
    </tr>
    <tr>
      <td>page</td>
      <td>-</td>
      <td>Номер страницы</td>
    </tr>
    <tr>
      <td>filter[#{KEY}][]</td>
      <td>-</td>
      <td>Значение фильтра</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
Не забудьте указать обязательный параметр идентификатор ритейлера
</aside>

<h2 id="kartochka-produkta">Карточка продукта</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/products/6"</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10001"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">54.79</span><span class="p">,</span><span class="w">
    </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">55.79</span><span class="p">,</span><span class="w">
    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500 г."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">500.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы желтые из Эквадора"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"energy_value"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"presentation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Калорийность"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"96"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/6/mini/file.png"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/6/small/file.png"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/products/6/product/file.png"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"related_products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы мини"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.79</span><span class="p">,</span><span class="w">
        </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.99</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.20</span><span class="p">,</span><span class="w">
        </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">500.0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500 г."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы мини"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
        </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить данные для карточки продукта, можно выполнив запрос</p>

<h3 id="http-zapros-1">HTTP запрос</h3>

<p><code>GET http://api.instamart.ru/v2/products/#{PRODUCT_ID}</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>product_id</td>
      <td>Да</td>
      <td>ID продукта</td>
    </tr>
  </tbody>
</table>


          <h1 id="poisk">Поиск</h1>

<h2 id="podskazki-poiska">Подсказки поиска</h2>

<blockquote>
  <p>Пример запроса подсказок, для слова “чай”</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v2/searches/suggestions?rid=1&amp;q=%D1%87%D0%B0%D0%B9'</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"suggestion"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"taxons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
        </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"33688"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Для получения списка подсказок поиска, выполните запрос:</p>

<p><code>GET http://api.instamart.ru/v2/searches/suggestions</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера, по которому происходит поиск</td>
    </tr>
    <tr>
      <td><code>q</code></td>
      <td>Да</td>
      <td>Поисковая фраза</td>
    </tr>
  </tbody>
</table>

<h2 id="riezultaty-poiska">Результаты поиска</h2>

<blockquote>
  <p>Пример запроса результатов поиска, для слова “чай”</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v2/searches?rid=1&amp;q=%D1%87%D0%B0%D0%B9'</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать продукты, сгруппированные по категориям:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">324</span><span class="p">,</span><span class="w">
    </span><span class="nt">"taxon_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">187</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6560</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16563"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай черный Greenfield Golden Ceylon цейлонский пакетированный"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">309.34</span><span class="p">,</span><span class="w">
      </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">309.34</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">200.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100 пак."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/8161/mini/16563.jpg?1473242827"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/8161/small/16563.jpg?1473242827"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/8161/product/16563.jpg?1473242827"</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}]</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nt">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Для получения результатов поиска, выполните запрос:</p>

<p><code>GET http://api.instamart.ru/v2/searches</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера, по которому происходит поиск</td>
    </tr>
    <tr>
      <td><code>q</code></td>
      <td>Да</td>
      <td>Поисковая фраза</td>
    </tr>
    <tr>
      <td><code>page</code></td>
      <td>–</td>
      <td>Номер страницы с группами (по умолчанию 1)</td>
    </tr>
  </tbody>
</table>

          <h1 id="zakazy">Заказы</h1>

<h2 id="sozdaniie-novogho-zakaza">Создание нового заказа</h2>

<blockquote>
  <p>Пример вызова для авторизованного пользователя:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X POST
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R314234460"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Заголовок “Authorization” является необязательным для данного API метода. Пример вызова для неавторизованного пользователя:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders"</span> -X POST
</code></pre>

<p>Создать новый заказ можно, выполнив следующий запрос:</p>

<p><code>POST http://api.instamart.ru/v2/orders</code></p>

<p>Вызов можно выполнить как для авторизованных пользователей, так и для неавторизованных. Если заголовок <code>Authorization</code> не будет указан, то созданый заказ не привяжется к пользователю.<br />
Для каждого пользователя может быть создано сколько угодно заказов, но если у текущего пользователя уже есть незавершенный заказ, сервер вернет ошибку с кодом <code>422</code> и заказ не будет создан.<br />
Объект <code>Order</code>, возвращаемый сервером, содержит информацию о заказе, заказанных товарах и скидках.<br />
В один заказ могут быть добавлены товары от разных ритейлеров. Заказанные товары, в разбивке по ритейлерам, можно получить из поля <code>shipments</code> заказа.</p>

<h3 id="struktura-obiekta-order">Структура объекта Order</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>number</td>
      <td>номер заказа</td>
    </tr>
    <tr>
      <td>total</td>
      <td>итоговая сумма заказа</td>
    </tr>
    <tr>
      <td>item_total</td>
      <td>сумма всех позиций заказа, без скидки</td>
    </tr>
    <tr>
      <td>ship_total</td>
      <td>стоимость доставки</td>
    </tr>
    <tr>
      <td>adjustment_total</td>
      <td>сумма скидок</td>
    </tr>
    <tr>
      <td>shipment_state</td>
      <td>состояние доставки</td>
    </tr>
    <tr>
      <td>payment_state</td>
      <td>состояние оплаты</td>
    </tr>
    <tr>
      <td>special_instructions</td>
      <td>примечание к заказу</td>
    </tr>
    <tr>
      <td>address</td>
      <td>адрес доставки</td>
    </tr>
    <tr>
      <td>shipments</td>
      <td>данные о добавленных товаров</td>
    </tr>
    <tr>
      <td>payment</td>
      <td>данные об оплате</td>
    </tr>
    <tr>
      <td>adjustments</td>
      <td>корректировки стоимости заказа (скидки, цена доставки)</td>
    </tr>
  </tbody>
</table>

<h3 id="struktura-obiekta-shipment">Структура объекта Shipment</h3>

<p>Объект <code>Shipment</code> создается на каждого ритейлера, товары которого были добавлены в заказ.</p>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>id пакета</td>
    </tr>
    <tr>
      <td>alerts</td>
      <td>список предупреждений об ошибках в заказе</td>
    </tr>
    <tr>
      <td>promotions</td>
      <td>список предложенй о скидках и пр.</td>
    </tr>
    <tr>
      <td>total</td>
      <td>суммарная стоимость добавленных позиций</td>
    </tr>
    <tr>
      <td>next_deliveries</td>
      <td>предлагаемые окна доставки</td>
    </tr>
    <tr>
      <td>retailer</td>
      <td>информация о ритейлере</td>
    </tr>
    <tr>
      <td>line_items</td>
      <td>список позиций</td>
    </tr>
  </tbody>
</table>

<h3 id="struktura-obiekta-payment">Структура объекта Payment</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>number</td>
      <td>номер платежа</td>
    </tr>
    <tr>
      <td>state</td>
      <td>состояние платежа</td>
    </tr>
    <tr>
      <td>is_finalization_needed</td>
      <td>требуется ли оформление платежа</td>
    </tr>
    <tr>
      <td>finalization_url</td>
      <td>url перехода для оформления платежа</td>
    </tr>
  </tbody>
</table>

<p>Платеж может быть в следующих состояниях</p>

<table>
  <thead>
    <tr>
      <th>Состояние</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>checkout</td>
      <td>начальное состояние</td>
    </tr>
    <tr>
      <td>completed</td>
      <td>завершен</td>
    </tr>
    <tr>
      <td>invalid</td>
      <td>отказ на стороне платежной системы</td>
    </tr>
    <tr>
      <td>processing</td>
      <td>ожидает ответа платежной системы</td>
    </tr>
    <tr>
      <td>void</td>
      <td>отменен администратором</td>
    </tr>
  </tbody>
</table>

<h3 id="struktura-obiekta-lineitem">Структура объекта LineItem</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>id позиции</td>
    </tr>
    <tr>
      <td>quantity</td>
      <td>количество товаров</td>
    </tr>
    <tr>
      <td>description</td>
      <td>текстовое описание содержимого</td>
    </tr>
    <tr>
      <td>price</td>
      <td>стоимость одной позиции</td>
    </tr>
    <tr>
      <td>total</td>
      <td>сумма</td>
    </tr>
    <tr>
      <td>product</td>
      <td>информация о продукте</td>
    </tr>
  </tbody>
</table>

<h2 id="poluchieniie-zakaza-po-nomieru">Получение заказа по номеру</h2>

<blockquote>
  <p>Пример команды:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/C27387-16"</span>
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"C27387-16"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
    </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-11T12:28:03.000+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-11T12:28:04.000+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"alerts"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Добавьте больше товаров для заказа"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"full_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Минимальная сумма заказа 229 р. в \"Metro C&amp;C\" не набрана"</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nt">"promotions"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бесплатная доставка при заказе на сумму от 2999"</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
      </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
      </span><span class="nt">"next_deliveries"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">350.0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="s2">"сегодня, 09:00-12:00"</span><span class="w">
      </span><span class="p">}],</span><span class="w">
      </span><span class="nt">"retailer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Metro C&amp;C"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#003d7a"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"logo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://s11.postimg.org/kg57t4yrn/metro_logo_s.png"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">548260</span><span class="p">,</span><span class="w">
        </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
        </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Цикорий Elza – растворимый гранулированный напиток с насыщенным кофейным вкусом и ароматом.Содержащийся в цикории инулин способствует улучшению обмена веществ и пищеварения. Оказывает успокаивающее действие на нервную систему, улучшает работу сердца. Цикорий повышает иммунитет,очищает организм. Он богат минеральными веществами, витаминами и микроэлементами."</span><span class="p">,</span><span class="w">
        </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">960</span><span class="p">,</span><span class="w">
          </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10963"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Цикорий Elza гранулированный"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
          </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">229.89</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100 г."</span><span class="p">,</span><span class="w">
          </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">100.0</span><span class="p">,</span><span class="w">
          </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Цикорий Elza – растворимый гранулированный напиток с насыщенным кофейным вкусом и ароматом.Содержащийся в цикории инулин способствует улучшению обмена веществ и пищеварения. Оказывает успокаивающее действие на нервную систему, улучшает работу сердца. Цикорий повышает иммунитет,очищает организм. Он богат минеральными веществами, витаминами и микроэлементами."</span><span class="p">,</span><span class="w">
          </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
            </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/3882/mini/10963.jpg?1473242393"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/3882/small/10963.jpg?1473242393"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/3882/product/10963.jpg?1473242393"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"original_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/3882/original/10963.jpg?1473242393"</span><span class="w">
          </span><span class="p">}]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}],</span><span class="w">
    </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить заказ можно, выполнив запрос:<br />
<code>GET http://api.instamart.ru/v2/orders/#{NUMBER}</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NUMBER</td>
      <td>Да</td>
      <td>Номер заказа</td>
    </tr>
  </tbody>
</table>

<h2 id="poluchieniie-tiekushchiegho-zakaza-polzovatielia">Получение текущего заказа пользователя</h2>

<blockquote>
  <p>Пример команды:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/current"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span>
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"order"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R314234460"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить текущий заказ пользователя можно, выполнив запрос:<br />
<code>GET http://api.instamart.ru/v2/orders/current</code></p>

<p>В случае, если у пользователя нет текущего заказа, данный запрос вернет ошибку с кодом <code>404</code></p>

<h2 id="poluchieniie-spiska-vsiekh-zakazov">Получение списка всех заказов</h2>

<blockquote>
  <p>Пример команды:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span>
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"orders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R314234460"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-23T16:19:29.284+03:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
      </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">

  </span><span class="nt">"meta"</span><span class="p">:{</span><span class="w">
    </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить все заказы пользователя можно, выполнив запрос:<br />
<code>GET http://api.instamart.ru/v2/orders</code></p>

<h2 id="dobavlieniie-pozitsii-zakaza">Добавление позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/line_items"</span> <span class="se">\</span>
  -d line_item[order_number]<span class="o">=</span>R314234460 <span class="se">\</span>
  -d line_item[product_id]<span class="o">=</span>6 <span class="se">\</span>
  -d line_item[quantity]<span class="o">=</span>2
</code></pre>
<blockquote>
  <p>В ответе вернется созданный <code>line_item</code>:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">520884</span><span class="p">,</span><span class="w">
    </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">35.99</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Пробиотические продукты Активиа содержат уникальные бифидобактерия ActiRegularis, отобранные Данон за жизнеспособность и эффективную помощь организму. Ежедневная потребление Активиа помогает работе кишечника и способствует естественному очищению организма. Научные исследования подтвердили эффективность Активиа уже после 2-х недель ежедневного потребления. Изготовлено без добавления консервантов."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">71.98</span><span class="p">,</span><span class="w">
    </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10006"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Напиток Danone Aktivia кисломолочный чернослив 2,0%"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">35.99</span><span class="p">,</span><span class="w">
      </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.12</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-6.13</span><span class="p">,</span><span class="w">
      </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">290.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"290 г."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/mini/10006.jpg?1473242617"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/small/10006.jpg?1473242617"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/product/10006.jpg?1473242617"</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Добавить позицию к заказу можно, выполнив запрос:</p>

<p><code>POST http://api.instamart.ru/v2/line_items</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>line_item[order_number]</td>
      <td>Да</td>
      <td>Номер заказа</td>
    </tr>
    <tr>
      <td>line_item[product_id]</td>
      <td>Да</td>
      <td>ID продукта</td>
    </tr>
    <tr>
      <td>line_item[quantity]</td>
      <td>Да</td>
      <td>количество добавляемых позиций</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
  После добавления новой позиции не забудьте перезагрузить заказ.
</aside>

<h2 id="riedaktirovaniie-pozitsii-zakaza">Редактирование позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/line_items/520884"</span> <span class="se">\</span>
  -d line_item[quantity]<span class="o">=</span>10 <span class="se">\</span>
  -X PUT
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"line_item"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">520884</span><span class="p">,</span><span class="w">
    </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">35.99</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Пробиотические продукты Активиа содержат уникальные бифидобактерия ActiRegularis, отобранные Данон за жизнеспособность и эффективную помощь организму. Ежедневная потребление Активиа помогает работе кишечника и способствует естественному очищению организма. Научные исследования подтвердили эффективность Активиа уже после 2-х недель ежедневного потребления. Изготовлено без добавления консервантов."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">359.9</span><span class="p">,</span><span class="w">
    </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sku"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10006"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Напиток Danone Aktivia кисломолочный чернослив 2,0%"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">35.99</span><span class="p">,</span><span class="w">
      </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">42.12</span><span class="p">,</span><span class="w">
      </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-6.13</span><span class="p">,</span><span class="w">
      </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mf">290.0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"human_volume"</span><span class="p">:</span><span class="w"> </span><span class="s2">"290 г."</span><span class="p">,</span><span class="w">
      </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/mini/10006.jpg?1473242617"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/small/10006.jpg?1473242617"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://instamart.ru/spree/products/5946/product/10006.jpg?1473242617"</span><span class="w">
      </span><span class="p">}]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Чтобы изменить количество единиц товара, необходимо выполнить запрос:</p>

<p><code>PUT http://api.instamart.ru/v2/line_items/#{ID}</code></p>

<h3 id="paramietry-zaprosa-2">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ID</td>
      <td>Да</td>
      <td>ID позиции заказа</td>
    </tr>
    <tr>
      <td>line_item[quantity]</td>
      <td>Нет</td>
      <td>Количество единиц товара</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
  После редактирования позиции не забудьте перезагрузить заказ.
</aside>

<h2 id="udalieniie-pozitsii-zakaza">Удаление позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/line_items/520884"</span> <span class="se">\</span>
  -X DELETE
</code></pre>
<blockquote>
  <p>Ответ вернет результат с кодом 200</p>
</blockquote>

<p>Чтобы удалить позицию заказа, необходимо выполнить запрос:</p>

<p><code>DELETE http://api.instamart.ru/v2/line_items/#{ID}</code></p>

<h3 id="paramietry-zaprosa-3">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ID</td>
      <td>Да</td>
      <td>ID позиции заказа</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
  После добавления новой позиции не забудьте перезагрузить заказ.
</aside>

<h2 id="oformlieniie-zakaza">Оформление заказа</h2>

<blockquote>
  <p>Пример команды для выбора адреса доставки и заполнения коментария доставки:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/#{NUMBER}"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X PUT <span class="se">\</span>
  -d <span class="s2">"order[address_attributes][id]=1"</span> <span class="se">\</span>
  -d <span class="s2">"order[address_attributes][instructions]=1"</span>
</code></pre>
<blockquote>
  <p>Если данные были указаны верно, ответ будет содержать json-документ заказа:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R307128032"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cart"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.724Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.752Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total_quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"full_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Старая Басманная 3"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
  </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Пример команды для заполнения контактного телефона:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/#{NUMBER}"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -X PUT <span class="se">\</span>
  -d <span class="s2">"order[phone_attributes][value]=+7(495)111-22-33"</span>
</code></pre>

<blockquote>
  <p>Формат телефона не имеет значения, необходимо только чтобы был код из 3х цифр и номер из 7. Также необходимо учесть текущее ограничение: для сохранения номера телефона у заказа должен быть адрес. Т.е. телефон можно сохранить либо вместе с адресом, либо если адрес уже сохранен.</p>
</blockquote>

<blockquote>
  <p>Пример команды выбора интервала и способа доставки (id шипмента - 1):</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/#{NUMBER}"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -d <span class="s2">"order[shipments_attributes][id]=1"</span>
  -d <span class="s2">"order[shipments_attributes][delivery_window_id]=1"</span>
  -d <span class="s2">"order[shipments_attributes][shipping_method_id]=1"</span>
</code></pre>

<blockquote>
  <p>Пример выбора метода оплаты:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/#{NUMBER}"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -d <span class="s2">"order[payment_attributes][payment_tool_id]=1"</span>
</code></pre>

<blockquote>
  <p>В ответе вернется заказ с дополнительным объектом payment:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R307128032"</span><span class="p">,</span><span class="w">
  </span><span class="err">...</span><span class="w">
  </span><span class="nt">"payment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">21156</span><span class="p">,</span><span class="w">
    </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkout"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"is_finalization_needed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nt">"finalization_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Чтобы заполнить информацию о заказе, необходимо выполнить запрос:</p>

<p><code>PUT http://api.instamart.ru/v2/orders/#{NUMBER}</code></p>

<h3 id="vybor-sposoba-dostavki-i-vriemieni-dostavki">Выбор способа доставки и времени доставки</h3>

<p>Получить список способов доставки, необходимый для оформления заказа, можно выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/shipping_methods</code></p>

<p>Окна доставки можно получить, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/shipments/#{SHIPMENT_ID}/delivery_windows</code></p>

<p>которому можно передать параметр <code>date</code> для выбора окон доставки за конкретный день.</p>

<h3 id="vybor-sposoba-oplaty">Выбор способа оплаты</h3>

<p>Получить список способов оплаты, необходимый для оформления платежа, можно выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/payment_tools</code></p>

<h3 id="paramietry-zaprosa-4">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NUMBER</td>
      <td>Да</td>
      <td>Номер заказа</td>
    </tr>
    <tr>
      <td>order[address_attributes][id]</td>
      <td>Да (для завершения)</td>
      <td>Адрес доставки</td>
    </tr>
    <tr>
      <td>order[address_attributes][instructions]</td>
      <td>-</td>
      <td>Комментарий к заказу</td>
    </tr>
    <tr>
      <td>order[shipments_attributes][][id]</td>
      <td>Да</td>
      <td>id shipment’а</td>
    </tr>
    <tr>
      <td>order[shipments_attributes][][delivery_window_id]</td>
      <td>Да</td>
      <td>id слота доставки</td>
    </tr>
    <tr>
      <td>order[shipments_attributes][][shipping_method_id]</td>
      <td>Да</td>
      <td>id cпособа доставки</td>
    </tr>
    <tr>
      <td>order[payment_attributes][payment_tool_id]</td>
      <td>Да</td>
      <td>id источника оплаты</td>
    </tr>
  </tbody>
</table>

<h2 id="zaviershieniie-zakaza">Завершение заказа</h2>

<p>Чтобы завершить заказ, необходимо выполнить запрос:</p>

<p><code>POST http://api.instamart.ru/v2/orders/#{NUMBER}/completion</code></p>

          <h1 id="sposoby-dostavki">Способы доставки</h1>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/shipping_methods"</span>
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"shipping_methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Курьером"</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить список доступных способов доставки можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/shipping_methods</code></p>

          <h1 id="okna-dostavki">Окна доставки</h1>

<h2 id="poluchieniie-okon-dlia-ghruza-shipment">Получение окон для груза (shipment)</h2>

<blockquote>
  <p>Пример получения интервалов доставки для конкретного дня:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/shipments/4/delivery_windows?date=2016-01-01"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span>
</code></pre>

<blockquote>
  <p>Ответ:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"delivery_windows"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">26193</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">300.0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-16T09:00:00.000+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-10-16T12:00:00.000+03:00"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"presentation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"09:00-12:00"</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Чтобы получить окна доставки для груза, выполните следующий запрос:</p>

<p><code>GET /shipments/#{SHIPMENT_ID}/delivery_windows</code><br />
Данный запрос вернет все доступные окна доставки.<br />
Чтобы получить список окон доставки за конкретный день, указажите дополнительный параметр <code>date</code> в формате <code>yyyy-mm-dd</code> (или <code>dd-mm-yyyy</code>).</p>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SHIPMENT_ID</td>
      <td>Да</td>
      <td>id груза</td>
    </tr>
    <tr>
      <td>date</td>
      <td>Нет</td>
      <td>Дата доставки</td>
    </tr>
  </tbody>
</table>


          <h1 id="sposoby-oplaty">Способы оплаты</h1>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/payment_tools"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span>
</code></pre>

<blockquote>
  <p>Ответ будет содержать следующие данные:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"payment_tools"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Банковской картой"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"payanyway"</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Наличными курьеру"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check"</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="nt">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"current_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"next_page"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_pages"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"per_page"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>API способов оплаты возвращает список инструментов, который пользователь видит, оформляя заказ и может использовать для оплаты заказа.</p>

<p>У каждого пользователя свой собственный список способов оплаты, который включает стандартные способы: оплата наличными, оплата через платежный шлюз, а также способы, добавленные самим пользователем: оплата банковской картой, оплата по реквизитам компании.</p>

<p>Получить список доступных пользователю способов оплаты можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/payment_tools</code></p>

<h3 id="struktura-obiekta-paymenttool">Структура объекта PaymentTool</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>id</td>
      <td>идентификатор</td>
    </tr>
    <tr>
      <td>name</td>
      <td>название</td>
    </tr>
    <tr>
      <td>type</td>
      <td>тип способа оплаты</td>
    </tr>
  </tbody>
</table>

<p>На данный момент поддерживаются следующие типы способов оплаты:</p>

<table>
  <thead>
    <tr>
      <th>Тип</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>check</td>
      <td>наличными</td>
    </tr>
    <tr>
      <td>payanyway</td>
      <td>платежный шлюз moneta.ru</td>
    </tr>
    <tr>
      <td>sber_bank_invoice</td>
      <td>перевод по реквизитам</td>
    </tr>
  </tbody>
</table>

<p>Список типов нефиксированный и может меняться.</p>

          <h1 id="oformlieniie-platiezha">Оформление платежа</h1>

<p>При оформлении заказа пользователь выбирает один из способов оплаты, которым он будет оплачивать заказ.</p>

<p>Для совершения платежа некоторые способы оплаты требуют дополнительных действий со стороны пользователя на стороннем сайте. API возвращает необходимую для этого информацию вместе с заказом, в объекте Payment.</p>

<h3 id="struktura-obiekta-payment">Структура объекта Payment</h3>

<table>
  <thead>
    <tr>
      <th>Атрибут</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>number</td>
      <td>номер платежа</td>
    </tr>
    <tr>
      <td>state</td>
      <td>состояние платежа</td>
    </tr>
    <tr>
      <td>is_finalization_needed</td>
      <td>требуется ли оформление платежа</td>
    </tr>
    <tr>
      <td>finalization_url</td>
      <td>url перехода для оформления платежа</td>
    </tr>
  </tbody>
</table>

<p>Если выбранный пользователем способ оплаты предполагает оформление платежа на стороннем сайте, то поле <code>is_finalization_needed</code> будет содержать значение <code>true</code>. В этом случае клиент API должен отобразить пользователю сайт внутри web-view компонента по ссылке из поля <code>finalization_url</code>. Пользователь осуществляет оплату (включая 3d-secure авторизацию) внутри этого компонента. После завершения оплаты пользователь будет переадресован на сайт instamart.ru, по этому переходу web-view можно будет закрыть.</p>

<aside class="success">
  Сигналом завершения оплаты будет переадресация из стороннего сервиса на хост instamart.ru
</aside>

<p>Например, для сервиса <code>moneta.ru</code> пользователь в случае успешной и неуспешной оплаты будет перенаправлен по соответствующим адресам:</p>

<ul>
  <li>http://instamart.ru/gateway/payanyway/success</li>
  <li>http://instamart.ru/gateway/payanyway/fail</li>
</ul>

<aside class="warning">
  У каждого сервиса может быть свой собственный набор URL для переадрессации.
</aside>

          <h1 id="otzyv-na-zakaz">Отзыв на заказ</h1>

<h2 id="poluchieniie-spiska-zakazov-biez-otzyvov">Получение списка заказов без отзывов</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/unrated"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> 
</code></pre>

<p>Получить список заказов без отзывов можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/orders/unrated</code></p>

<p>Запрос вернет заказы, завершеные не позднее 10 дней назад</p>

<h2 id="sozdaniie-otzyva">Создание отзыва</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v2/orders/C36324/reviews"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=#{TOKEN}"</span> <span class="se">\</span>
  -d review[rate]<span class="o">=</span>2
  -d review[comment]<span class="o">=</span><span class="s1">'В коробку с заказом пролился отбеливатель'</span>
  -X POST
</code></pre>

<p>Добавить отзыв к заказу можно, выполнив запрос:</p>

<p><code>GET http://api.instamart.ru/v2/orders/#{ORDER_NUMBER}/reviews</code></p>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>review[rate]</td>
      <td>Да</td>
      <td>Оценка</td>
    </tr>
    <tr>
      <td>review[comment]</td>
      <td>-</td>
      <td>Комментарий</td>
    </tr>
  </tbody>
</table>

          <h1 id="zhaloby-na-tovar">Жалобы на товар</h1>

<h2 id="poluchieniie-spiska-standartnykh-zhalob">Получение списка стандартных жалоб</h2>

<pre class="highlight shell"><code>curl <span class="s2">"https://api.instamart.ru/v2/flags"</span>
</code></pre>
<blockquote>
  <p>Эта комманда возвращает следующий JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Неверное описание"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<aside class="warning">
  not implemented
</aside>

<p>Стандартный список ошибок можно загрузить, выполнив запрос:</p>

<p><code>GET https://api.instamart.ru/v2/flags</code></p>

<h2 id="otpravka-zhaloby">Отправка жалобы</h2>

<blockquote>
  <p>Пример отправки стандартной жалобы из списка:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"https://api.instamart.ru/v2/products/1/flags"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=&lt;% TOKEN %&gt;"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d product_flag[flag_id]<span class="o">=</span>1
</code></pre>

<blockquote>
  <p>Пример отправки собственной жалобы</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s2">"https://api.instamart.ru/v2/products/#{PRODUCT_ID}/flags"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Token token=&lt;% TOKEN %&gt;"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s2">"product_flag[description]=Слишком высокая цена"</span>
</code></pre>

<aside class="warning">
  not implemented
</aside>

<p>Чтобы отправить жалобу на товар, выполните следующий запрос, указав <code>id</code> жалобы:</p>

<p><code>POST https://api.instamart.ru/v2/products/#{PRODUCT_ID}/flags</code></p>

<p>Также, используя этот же URL, можно отправить свой текст жалобы, указав его в параметре <code>description</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>product_id</td>
      <td>Да</td>
      <td>id продукта</td>
    </tr>
    <tr>
      <td>product_flag[flag_id]</td>
      <td>Да (если не указан <code>description</code>)</td>
      <td>id жалобы</td>
    </tr>
    <tr>
      <td>product_falg[description]</td>
      <td>Да (если не указан <code>flag_id</code>)</td>
      <td>текст жалобы</td>
    </tr>
  </tbody>
</table>

          <h1 id="oshibki">Ошибки</h1>

<p>В Instamart API поддерживаются коды ошибок:</p>

<table>
  <thead>
    <tr>
      <th>Код ошибки</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>400</td>
      <td>Bad Request – Невалидный запрос</td>
    </tr>
    <tr>
      <td>401</td>
      <td>Unauthorized – Неправильный ключ API</td>
    </tr>
    <tr>
      <td>403</td>
      <td>Forbidden – Недостаточно прав для получения ресурса.</td>
    </tr>
    <tr>
      <td>404</td>
      <td>Not Found – Запрашиваемый ресурс не найден.</td>
    </tr>
    <tr>
      <td>500</td>
      <td>Internal Server Error – Ошибка не сервере. Попробуйте позже.</td>
    </tr>
    <tr>
      <td>503</td>
      <td>Service Unavailable – Технические работы, API временно недоступно. Попробуйте позже.</td>
    </tr>
  </tbody>
</table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
