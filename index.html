<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Документация Instamart API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'></a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="vviedieniie">Введение</h1>

<p>Спецификация API Instamart</p>

<blockquote>
  <p>API endpoint</p>
</blockquote>

<pre class="highlight shell"><code>http://api.instamart.ru
</code></pre>

<p>Instamart API построено в соответствии с архитектурой REST. Все URL в API имеют единую структуру и соответствуют отдельным ресурсам. Ответы API используют HTTP коды состояния для обозначения результата выполнения запроса. Мы используем встроенные механизмы HTTP, такие как HTTP методы, HTTP аутентификация и заголовки, которые поддерживаются всеми HTTP клиентами. Все запросы к API возвращают ответ в формате JSON, со всеми данными, включая ошибки.</p>

<p>Чтобы облегчить изучение API пользователю предоставляется тестовый API ключ.</p>


          <h1 id="polzovatieli">Пользователи</h1>

<h2 id="poluchieniie-dannykh-polzovatielia">Получение данных пользователя</h2>

<blockquote>
  <p>Пример кода для получения данных пользователя</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/users/test@test.com'</span>
</code></pre>
<blockquote>
  <p>Если пользователь существует, ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
  <p>Если пользователя не существует, сервер вернет ответ с кодом 404</p>
</blockquote>

<p>Получить данные пользователя можно, выполнив запрос:<br />
<code>GET http://api.instamart.ru/v1/users/&lt;EMAIL&gt;</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="rieghistratsiia-novogho-polzovatielia">Регистрация нового пользователя</h2>

<blockquote>
  <p>Пример кода для регистрации нового пользователя</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/users/registrations'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="nv">password</span><span class="o">=</span>&lt;PASSWORD&gt; <span class="se">\</span>
  -d <span class="nv">first_name</span><span class="o">=</span>&lt;FIRSTNAME&gt; <span class="se">\</span>
  -d <span class="nv">last_name</span><span class="o">=</span>&lt;LASTNAME&gt;
</code></pre>

<p>Зарегистрировать нового пользователя можно, выполнив запрос:</p>

<p><code>POST http://api.instamart.ru/v1/users/registrations</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>password</td>
      <td>Да</td>
      <td>Пароль</td>
    </tr>
    <tr>
      <td>first_name</td>
      <td>Да</td>
      <td>Имя пользователя</td>
    </tr>
    <tr>
      <td>last_name</td>
      <td>Да</td>
      <td>Фамилия пользователя</td>
    </tr>
  </tbody>
</table>

          <h1 id="autientifikatsiia">Аутентификация</h1>

<p>Для доступа к API Instamart пользователь должен пройти процедуру аутентификации и получить токен доступа.</p>

<h2 id="autientifikatsiia-chieriez-iemieil-i-parol">Аутентификация через емейл и пароль</h2>

<blockquote>
  <p>Пример кода для аутентификации пользователя с учетными данными “test@test.ru”, “qwer”:</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/sessions'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic dGVzdEB0ZXN0LnJ1OnF3ZXIK'</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FWtn0HAjBD6rNxWwEV0Cj7JXSEPGJQ"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Аутентификация осуществляется методом <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basic Auth</a>.</p>

<p>Получить токен можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v1/sessions</code></p>

<p>Учетные данные пользователя (емейл и пароль) передаются в заголовке запроса вида:<br />
<code>Authorization: Basic &lt;DIGEST&gt;</code><br />
где <code>&lt;DIGEST&gt;</code> формируется следующим способом: <code>base64(email + ':' + password)</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
    <tr>
      <td>password</td>
      <td>Да</td>
      <td>Пароль пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="autientifikatsiia-chieriez-sotsialnyie-sieti">Аутентификация через социальные сети</h2>

<blockquote>
  <p>Пример кода для аутентификации пользователя через vkontakte</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/XXX'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="nv">uid</span><span class="o">=</span>&lt;UID&gt; <span class="se">\</span>
  -d <span class="nv">provider</span><span class="o">=</span>vkontakte
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"FWtn0HAjBD6rNxWwEV0Cj7JXSEPGJQ"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить токен можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v1/XXX</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>uid</td>
      <td>Да</td>
      <td>Идентификатор пользователя в социальной сети</td>
    </tr>
    <tr>
      <td>provider</td>
      <td>Да</td>
      <td>Название социальной сети (vkontakte / facebook)</td>
    </tr>
    <tr>
      <td>first_name</td>
      <td>Да</td>
      <td>Имя пользователя</td>
    </tr>
    <tr>
      <td>last_name</td>
      <td>Да</td>
      <td>Фамилия пользователя</td>
    </tr>
    <tr>
      <td>email</td>
      <td>-</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

          <h1 id="vosstanovlieniie-parolia">Восстановление пароля</h1>

<h2 id="zapros-na-vosstanovlieniie-parolia">Запрос на восстановление пароля</h2>

<blockquote>
  <p>Пример кода c запросом на “восстановление пароля”</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/passwords/reset'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="nv">email</span><span class="o">=</span>&lt;EMAIL&gt;
</code></pre>

<blockquote>
  <p>Если пользователя не существует, то сервер вернет ответ с кодом 404</p>
</blockquote>

<p>Отправить пользователю письмо с инструкцией “восстановления пароля” можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v1/passwords/reset</code></p>

<p>Письмо будет содержать ссылку на приложение с параметром <code>reset_password_token</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>email</td>
      <td>Да</td>
      <td>Емейл пользователя</td>
    </tr>
  </tbody>
</table>

<h2 id="sbros-parolia">Сброс пароля</h2>

<blockquote>
  <p>Пример кода c запросом сброса пароля</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/passwords'</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="nv">reset_password_token</span><span class="o">=</span>&lt;TOKEN&gt;
  -d <span class="nv">password</span><span class="o">=</span>&lt;PASSWORD&gt;
  -d <span class="nv">password_confirmation</span><span class="o">=</span>&lt;PASSWORD_CONFIRMATION&gt;
</code></pre>

<p>Сбросить пароль пользователя можно, выполнив запрос:<br />
<code>POST http://api.instamart.ru/v1/passwords</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>reset_password_token</td>
      <td>Да</td>
      <td>Токен для сброса пароля</td>
    </tr>
    <tr>
      <td>password</td>
      <td>Да</td>
      <td>Пароль</td>
    </tr>
    <tr>
      <td>password_confirmation</td>
      <td>Да</td>
      <td>Подтверждение пароля</td>
    </tr>
  </tbody>
</table>


          <h1 id="ritieiliery">Ритейлеры</h1>

<h2 id="poluchit-spisok-ritieilierov">Получить список ритейлеров</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v1/retailers"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Basic &lt;% key %&gt;"</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Metro"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"logo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s3.instamart.ru/retailers/metro.png"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ашан"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"logo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s3.instamart.ru/retailers/auchan.png"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Получить список ритейлеров подключенных к Instamart можно выполнив запрос</p>

<h3 id="http-zapros">HTTP запрос</h3>

<p><code>GET http://api.instamart.ru/v1/retailers</code></p>

          <h1 id="katalogh">Каталог</h1>

<h2 id="vydacha-dlia-ghlavnoi-stranitsy">Выдача для главной страницы</h2>

<blockquote>
  <p>Пример команды</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/departments?rid=1'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай и кофе"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">668</span><span class="p">,</span><span class="w">
    </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
        </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
        </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
        </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 пак x 6"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
            </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Получить выдачу для главной страницы можно, выполнив следующий запрос:</p>

<p><code>GET http://api.instamart.ru/v1/departments</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список товаров.</td>
    </tr>
  </tbody>
</table>

<h2 id="vydacha-stranitsy-katieghorii">Выдача страницы категории</h2>

<blockquote>
  <p>Пример команды</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/departments/1?rid=1'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span>
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай и кофе"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"products_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">668</span><span class="p">,</span><span class="w">
  </span><span class="nt">"aisles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"product_counts"</span><span class="p">:</span><span class="w"> </span><span class="mi">327</span><span class="p">,</span><span class="w">
      </span><span class="nt">"taxon_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">267</span><span class="p">,</span><span class="w">
      </span><span class="nt">"products"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
          </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
          </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
          </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 пак x 6"</span><span class="p">,</span><span class="w">
          </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
          </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
              </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
              </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Получить выдачу страницы каталога можно, выполнив следующий запрос:</p>

<p><code>GET http://api.instamart.ru/v1/departments/&lt;DEPARTMENT_ID&gt;</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>rid</code></td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список товаров.</td>
    </tr>
    <tr>
      <td>DEPARTMENT_ID</td>
      <td>Да</td>
      <td>id категории</td>
    </tr>
  </tbody>
</table>

          <h1 id="produkty">Продукты</h1>

<h2 id="poluchit-spisok-produktov">Получить список продуктов</h2>

<pre class="highlight shell"><code>curl <span class="s2">"http://api.instamart.ru/v1/products?rid=1"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: Basic &lt;% key %&gt;"</span>
</code></pre>

<blockquote>
  <p>Команда выше возвращает JSON:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.79</span><span class="p">,</span><span class="w">
    </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.99</span><span class="p">,</span><span class="w">
    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.20</span><span class="p">,</span><span class="w">
    </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w">
    </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Бананы желтые из Эквадора"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
    </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s3.instamart.ru/products/1/mini/file.png"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s3.instamart.ru/products/1/small/file.png"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://s3.instamart.ru/products/1/product/file.png"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nt">"similar_products"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>Получить список продуктов доступных в текущий момент в Instamart можно выполнив запрос</p>

<h3 id="http-zapros">HTTP запрос</h3>

<p><code>GET http://api.instamart.ru/v1/products</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>rid</td>
      <td>Да</td>
      <td>ID ритейлера для которого необходимо получить список товаров.</td>
    </tr>
    <tr>
      <td>tid</td>
      <td>–</td>
      <td>ID категории. Если указан - вернутся только товары из этой категории.</td>
    </tr>
  </tbody>
</table>

<aside class="notice">
Не забудьте указать обязательный параметр идентификатор ритейлера
</aside>

          <h1 id="zakazy">Заказы</h1>

<h2 id="sozdaniie-novogho-zakaza">Создание нового заказа</h2>

<blockquote>
  <p>Пример команды</p>
</blockquote>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/orders'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span> <span class="se">\</span>
  -X POST
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R307128032"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cart"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.724Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.752Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payment_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spree@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total_quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ship_address"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Создать новый заказ можно, выполнив следующий запрос:</p>

<p><code>POST http://api.instamart.ru/v1/orders</code></p>

<h2 id="dobavlieniie-pozitsii-zakaza">Добавление позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/line_items'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span> <span class="se">\</span>
  -d line_item[product_id]<span class="o">=</span>1 <span class="se">\</span>
  -d line_item[quantity]<span class="o">=</span>5
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40.00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nihil et itaque adipisci sed ea dolorum."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"product_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
    </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
    </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 пак x 6"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"options_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Добавить позицию к заказу, можно выполнив запрос:</p>

<p><code>POST http://api.instamart.ru/v1/line_items</code></p>

<h3 id="paramietry-zaprosa">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>line_item[product_id]</td>
      <td>Да</td>
      <td>ID продукта</td>
    </tr>
    <tr>
      <td>line_item[quantity]</td>
      <td>Да</td>
      <td>количество добавляемых позиций</td>
    </tr>
  </tbody>
</table>

<h2 id="riedaktirovaniie-pozitsii-zakaza">Редактирование позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/line_items/1'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span> <span class="se">\</span>
  -d <span class="nv">quantity</span><span class="o">=</span>3 <span class="se">\</span>
  -X PATCH 
</code></pre>
<blockquote>
  <p>Ответ будет содержать следующие данные</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40.00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Nihil et itaque adipisci sed ea dolorum."</span><span class="p">,</span><span class="w">
  </span><span class="nt">"product_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"120.00"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"product"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Чай Lipton Yellow Label"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w">
    </span><span class="nt">"original_price"</span><span class="p">:</span><span class="w"> </span><span class="mi">70</span><span class="p">,</span><span class="w">
    </span><span class="nt">"discount"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
    </span><span class="nt">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10 пак x 6"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"items_per_pack"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"options_text"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="nt">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"mini_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"small_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"product_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"file.png?1370533476"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Чтобы, например, изменить количество единиц товара, необходимо выполнить запрос:</p>

<p><code>PATCH http://api.instamart.ru/v1/line_items/&lt;ID&gt;</code></p>

<h3 id="paramietry-zaprosa-1">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ID</td>
      <td>Да</td>
      <td>ID позиции заказа</td>
    </tr>
    <tr>
      <td>quantity</td>
      <td>Нет</td>
      <td>Количество единиц товара</td>
    </tr>
  </tbody>
</table>

<h2 id="udalieniie-pozitsii-zakaza">Удаление позиции заказа</h2>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/line_items/1'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span> <span class="se">\</span>
  -X DELETE 
</code></pre>
<blockquote>
  <p>Ответ вернет результат с кодом 200</p>
</blockquote>

<p>Чтобы удалить позицию заказа, необходимо выполнить запрос:</p>

<p><code>DELETE http://api.instamart.ru/v1/line_items/&lt;ID&gt;</code></p>

<h3 id="paramietry-zaprosa-2">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ID</td>
      <td>Да</td>
      <td>ID позиции заказа</td>
    </tr>
  </tbody>
</table>

<h2 id="zapolnieniie-adriesa-zakaza">Заполнение адреса заказа</h2>

<pre class="highlight shell"><code>curl <span class="s1">'http://api.instamart.ru/v1/checkouts/&lt;NUMBER&gt;'</span> <span class="se">\</span>
  -H <span class="s1">'Authorization: Basic &lt;TOKEN&gt;'</span> <span class="se">\</span>
  -d order[ship_address_attributes][city]<span class="o">=</span><span class="s2">"Москва"</span> <span class="se">\</span>
  -d order[ship_address_attributes][full_address]<span class="o">=</span><span class="s2">"Старая Басманная 3"</span> <span class="se">\</span>
</code></pre>
<blockquote>
  <p>Если данные были указаны верно, ответ будет содержать следующий json-документ:</p>
</blockquote>

<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"R307128032"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"item_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ship_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cart"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"adjustment_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nt">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.724Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2014-07-06T18:52:33.752Z"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payment_total"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"shipment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"payment_state"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spree@example.com"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"special_instructions"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nt">"total_quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nt">"ship_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Москва"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"full_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Старая Басманная 3"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"line_items"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
  </span><span class="nt">"payments"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nt">"shipments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">...</span><span class="p">],</span><span class="w">
  </span><span class="nt">"adjustments"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>Добавить адрес к заказу, можно выполнив следующий запрос:</p>

<p><code>PATCH http://api.instamart.ru/v1/checkouts/&lt;NUMBER&gt;</code></p>

<h3 id="paramietry-zaprosa-3">Параметры запроса</h3>

<table>
  <thead>
    <tr>
      <th>Параметр</th>
      <th>Обязательный</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>NUMBER</td>
      <td>Да</td>
      <td>Номер заказа</td>
    </tr>
    <tr>
      <td>order[ship_address_attributes][city]</td>
      <td>Да</td>
      <td>Город</td>
    </tr>
    <tr>
      <td>order[ship_address_attributes][full_address]</td>
      <td>Да</td>
      <td>Адрес</td>
    </tr>
  </tbody>
</table>

          <h1 id="oshibki">Ошибки</h1>

<p>В Instamart API поддерживаются коды ошибок:</p>

<table>
  <thead>
    <tr>
      <th>Код ошибки</th>
      <th>Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>400</td>
      <td>Bad Request – Невалидный запрос</td>
    </tr>
    <tr>
      <td>401</td>
      <td>Unauthorized – Неправильный ключ API</td>
    </tr>
    <tr>
      <td>403</td>
      <td>Forbidden – Недостаточно прав для получения ресурса.</td>
    </tr>
    <tr>
      <td>404</td>
      <td>Not Found – Запрашиваемый ресурс не найден.</td>
    </tr>
    <tr>
      <td>500</td>
      <td>Internal Server Error – Ошибка не сервере. Попробуйте позже.</td>
    </tr>
    <tr>
      <td>503</td>
      <td>Service Unavailable – Технические работы, API временно недоступно. Попробуйте позже.</td>
    </tr>
  </tbody>
</table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
